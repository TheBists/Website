(function(C,E){function L(f,n,q){Object.defineProperty(f,n,{writable:!1,configurable:!1,value:q})}function aa(f,n){Object.keys(n).forEach(function(q){var t="object"===typeof t?JSON.stringify(n[q]):n[q];f=f.replace(new RegExp("{{"+q+"}}","g"),t)});return f}function ba(f,n){if(!f)return!1;f=f.contentWindow&&f.contentWindow.document;if(!f)return!1;f.write(n);return!0}!function(f){function n(b,h){var k=(65535&b)+(65535&h);return(b>>16)+(h>>16)+(k>>16)<<16|65535&k}function q(b,h,k,d,g,l){b=n(n(h,b),n(d,
l));return n(b<<g|b>>>32-g,k)}function t(b,h,k,d,g,l,r){return q(h&k|~h&d,b,h,g,l,r)}function a(b,h,k,d,g,l,r){return q(h&d|k&~d,b,h,g,l,r)}function c(b,h,k,d,g,l,r){return q(k^(h|~d),b,h,g,l,r)}function e(b,h){b[h>>5]|=128<<h%32;b[(h+64>>>9<<4)+14]=h;var k=1732584193,d=-271733879,g=-1732584194,l=271733878;for(h=0;h<b.length;h+=16){var r=k;var m=d;var f=g;var p=l;k=t(k,d,g,l,b[h],7,-680876936);l=t(l,k,d,g,b[h+1],12,-389564586);g=t(g,l,k,d,b[h+2],17,606105819);d=t(d,g,l,k,b[h+3],22,-1044525330);k=
t(k,d,g,l,b[h+4],7,-176418897);l=t(l,k,d,g,b[h+5],12,1200080426);g=t(g,l,k,d,b[h+6],17,-1473231341);d=t(d,g,l,k,b[h+7],22,-45705983);k=t(k,d,g,l,b[h+8],7,1770035416);l=t(l,k,d,g,b[h+9],12,-1958414417);g=t(g,l,k,d,b[h+10],17,-42063);d=t(d,g,l,k,b[h+11],22,-1990404162);k=t(k,d,g,l,b[h+12],7,1804603682);l=t(l,k,d,g,b[h+13],12,-40341101);g=t(g,l,k,d,b[h+14],17,-1502002290);d=t(d,g,l,k,b[h+15],22,1236535329);k=a(k,d,g,l,b[h+1],5,-165796510);l=a(l,k,d,g,b[h+6],9,-1069501632);g=a(g,l,k,d,b[h+11],14,643717713);
d=a(d,g,l,k,b[h],20,-373897302);k=a(k,d,g,l,b[h+5],5,-701558691);l=a(l,k,d,g,b[h+10],9,38016083);g=a(g,l,k,d,b[h+15],14,-660478335);d=a(d,g,l,k,b[h+4],20,-405537848);k=a(k,d,g,l,b[h+9],5,568446438);l=a(l,k,d,g,b[h+14],9,-1019803690);g=a(g,l,k,d,b[h+3],14,-187363961);d=a(d,g,l,k,b[h+8],20,1163531501);k=a(k,d,g,l,b[h+13],5,-1444681467);l=a(l,k,d,g,b[h+2],9,-51403784);g=a(g,l,k,d,b[h+7],14,1735328473);d=a(d,g,l,k,b[h+12],20,-1926607734);k=q(d^g^l,k,d,b[h+5],4,-378558);l=q(k^d^g,l,k,b[h+8],11,-2022574463);
g=q(l^k^d,g,l,b[h+11],16,1839030562);d=q(g^l^k,d,g,b[h+14],23,-35309556);k=q(d^g^l,k,d,b[h+1],4,-1530992060);l=q(k^d^g,l,k,b[h+4],11,1272893353);g=q(l^k^d,g,l,b[h+7],16,-155497632);d=q(g^l^k,d,g,b[h+10],23,-1094730640);k=q(d^g^l,k,d,b[h+13],4,681279174);l=q(k^d^g,l,k,b[h],11,-358537222);g=q(l^k^d,g,l,b[h+3],16,-722521979);d=q(g^l^k,d,g,b[h+6],23,76029189);k=q(d^g^l,k,d,b[h+9],4,-640364487);l=q(k^d^g,l,k,b[h+12],11,-421815835);g=q(l^k^d,g,l,b[h+15],16,530742520);d=q(g^l^k,d,g,b[h+2],23,-995338651);
k=c(k,d,g,l,b[h],6,-198630844);l=c(l,k,d,g,b[h+7],10,1126891415);g=c(g,l,k,d,b[h+14],15,-1416354905);d=c(d,g,l,k,b[h+5],21,-57434055);k=c(k,d,g,l,b[h+12],6,1700485571);l=c(l,k,d,g,b[h+3],10,-1894986606);g=c(g,l,k,d,b[h+10],15,-1051523);d=c(d,g,l,k,b[h+1],21,-2054922799);k=c(k,d,g,l,b[h+8],6,1873313359);l=c(l,k,d,g,b[h+15],10,-30611744);g=c(g,l,k,d,b[h+6],15,-1560198380);d=c(d,g,l,k,b[h+13],21,1309151649);k=c(k,d,g,l,b[h+4],6,-145523070);l=c(l,k,d,g,b[h+11],10,-1120210379);g=c(g,l,k,d,b[h+2],15,718787259);
d=c(d,g,l,k,b[h+9],21,-343485551);k=n(k,r);d=n(d,m);g=n(g,f);l=n(l,p)}return[k,d,g,l]}function v(b){var h,k="";for(h=0;h<32*b.length;h+=8)k+=String.fromCharCode(b[h>>5]>>>h%32&255);return k}function b(b){var h,k=[];k[(b.length>>2)-1]=void 0;for(h=0;h<k.length;h+=1)k[h]=0;for(h=0;h<8*b.length;h+=8)k[h>>5]|=(255&b.charCodeAt(h/8))<<h%32;return k}function p(f){return v(e(b(f),8*f.length))}function G(f,h){var k,d=b(f),g=[],l=[];g[15]=l[15]=void 0;16<d.length&&(d=e(d,8*f.length));for(f=0;16>f;f+=1)g[f]=
909522486^d[f],l[f]=1549556828^d[f];return k=e(g.concat(b(h)),512+8*h.length),v(e(l.concat(k),640))}function D(b){var h,k="";for(h=0;h<b.length;h+=1){var d=b.charCodeAt(h);k+="0123456789abcdef".charAt(d>>>4&15)+"0123456789abcdef".charAt(15&d)}return k}function H(b,h,k){h?k?b=G(unescape(encodeURIComponent(h)),unescape(encodeURIComponent(b))):(b=G(unescape(encodeURIComponent(h)),unescape(encodeURIComponent(b))),b=D(b)):b=k?p(unescape(encodeURIComponent(b))):D(p(unescape(encodeURIComponent(b))));return b}
"function"==typeof define&&define.amd?define(function(){return H}):"object"==typeof module&&module.exports?module.exports=H:f.md5=H}(this);"undefined"===typeof Brid.AdSDK&&(Brid.AdSDK={});var V=E.BridIframeBurst?C.top:C;Brid.AdSDK.Util={urlParts:function(f){var n=E.createElement("a");n.setAttribute("href",f);return{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port?
n.port:80,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}},queryStringToObj:function(f,n){n=c.isFunction(n)?n:function(){return!0};f=f.trim().replace(/^\?/,"");f=f.split("&");var q={};f.forEach(function(f){if(""!==f){var t=f.split("=");f=t[0];t=t[1];n(f,t)&&(q[f]=t)}});return q},objToQueryString:function(f){var n=[];f.forEach(function(f,t){n.push(t+"="+f)});return n.join("&")},itemFromQueryString:function(f,n){n||(n=location.href);f=f.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");f=(new RegExp("[\\?&]"+
f+"=([^&#]*)")).exec(n);return null==f?null:f[1]},isArray:function(f){return"[object Array]"===Object.prototype.toString.call(f)},isFunction:function(f){return"[object Function]"==Object.prototype.toString.call(f)},decapitalize:function(f){return f.charAt(0).toLowerCase()+f.slice(1)},transformArray:function(f,n){var q=[];f.forEach(function(f,a){(f=n(f,a))&&q.push(f)});return q},timeouts:{},callbackTimeout:function(f,n,q){f=setTimeout(function(){n=function(){};delete c.timeouts[t];q()},f);var t=function(){n.apply(this,
arguments)&&c.clearCallbackTimeout(t)};c.timeouts[t]=f;return t},clearCallbackTimeout:function(f){var n=c.timeouts[f];n&&(clearTimeout(n),delete c.timeouts[f])},checkIfURLExists:function(f){try{var n=C.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP");n.open("HEAD",f,!1);n.onload=function(){};n.onerror=function(f){};n.send();return 404!==n.status&&403!==n.status}catch(q){return!1}},getOGG:function(f,n,q,t,a){for(var e,v="",u=0,b=f.length;u<b;u++)if(-1!=f[u].type.indexOf("video")&&
("video/mp4"==f[u].type||n)){e=f[u];-1<e.src.indexOf("youtube.com")&&(v=c.itemFromQueryString("video_id",e.src));f="string"==typeof q.adSystem?q.adSystem.toLocaleLowerCase():q.adSystem.toString();n=q.adTitle||"";q=((-1!=f.indexOf("gdfp")||-1!=f.indexOf("google")||-1!=f.indexOf("dcm")||-1!=f.indexOf("dart")||-1!=f.indexOf("freewheel")?f:q.id)+"_"+(q.creativeID||n.replace(/ /g,""))+"_"+v).replace(/\//g,"");a=t?"264":a;t="//cdn.brid.tv/live/partners/"+a+"/mobile/"+encodeURIComponent(q)+".ogg";c.checkIfURLExists(t)?
(e.mp3=t.replace("ogg","mp3").replace("mobile","mp3"),e.src=t,e.type="video/ogg"):(a="//apiunits.brid.tv/oggs/get/"+a+"/"+q+"/"+btoa(e.src)+".json",Brid.Loader.loadText(a,function(b){},function(b){}),e=!0);break}return e},VAST:{track:function(f,n){var q=[];u.parseURLMacros(f,n).forEach(function(f){var n=new Image;n.src=f;q.push(n)});return q},parseURLMacros:function(f,n){var q=[];n=n||{};n.CACHEBUSTING||(n.CACHEBUSTING=Math.round(1E10*Math.random()));"undefined"!=typeof f&&f.forEach(function(f){q.push(u._parseURLMacro(f,
n))});return q},parseURLMacro:function(f,n){n=n||{};n.CACHEBUSTING||(n.CACHEBUSTING=Math.round(1E10*Math.random()));return u._parseURLMacro(f,n)},_parseURLMacro:function(f,n){n=n||{};a.eachProp(n,function(n,a){f=f.replace(new RegExp("\\["+a+"\\]","gm"),n)});return f},parseTimeString:function(f){var n=/(\d\d):(\d\d):(\d\d)(\.(\d\d\d))?/,q;"string"===typeof f&&(f=f.match(n))&&(q=3600*parseInt(f[1],10)+60*parseInt(f[2],10)+parseInt(f[3],10)+parseInt(f[5]||0)/1E3);return isNaN(q)?null:q},parseImpressions:function(f){return f?
(f=c.isArray(f)?f:[f],c.transformArray(f,function(f){if(f.keyValue)return f.keyValue})):[]},parseCreatives:function(f){var n=[];f&&f.creative&&(f=c.isArray(f.creative)?f.creative:[f.creative],f.forEach(function(f){n.push(new ga(f))}));return n},parseExtensions:function(f){var n=[];f&&f.extension&&(f=c.isArray(f.extension)?f.extension:[f.extension],f.forEach(function(f){n.push(new ha(f))}));return n},parseTrackingEvents:function(f,n){var q=[];f&&(f=c.isArray(f)?f:[f],f.forEach(function(f){q.push(new ia(f,
n))}));return q},formatProgress:function(f){var n=Math.floor(f/36E5);var q=Math.floor(f/6E4%60);var c=Math.floor(f/1E3%60);f%=1E3;return a.round(n,2)+":"+a.round(q,2)+":"+a.round(c,2)+"."+a.round(f,3)},parseOffset:function(f,n){return/^\d+(\.\d+)?%$/g.test(f)?(n?(f=parseFloat(f.replace("%","")),n=n*f/100):n=null,n):u.parseTimeString(f)},VPAID_techs:[],isVPAID:function(f){return!!f&&"VPAID"===f.apiFramework},findSupportedVPAIDTech:function(f){var n;var q=0;for(n=u.VPAID_techs.length;q<n;q+=1){var a=
u.VPAID_techs[q];if(a.supports(f))return a}return null}},async:{setImmediate:function(f){setTimeout(f,0)},iterator:function(f){var n=function(q){var a=function(){f.length&&f[q].apply(null,arguments);return a.next()};a.next=function(){return q<f.length-1?n(q+1):null};return a};return n(0)},waterfall:function(f,n){n=n||function(){};if(!c.isArray(f))return n(Error("First argument to waterfall must be an array of functions"));if(!f.length)return n();var q=function(f){return function(a){if(a)n.apply(null,
arguments),n=function(){};else{var c=Array.prototype.slice.call(arguments,1),t=f.next();t?c.push(q(t)):c.push(n);R.setImmediate(function(){f.apply(null,c)})}}};q(R.iterator(f))()}},basync:{setImmediate:function(f){setTimeout(f,0)},iterator:function(f){var n=function(q){var a=function(){f.length&&f[q].apply(null,arguments);return a.next()};a.next=function(){return q<f.length-1?n(q+1):null};return a};return n(0)},waterfall:function(f,n){n=n||function(){};if(!c.isArray(f))return n(Error("First argument to waterfall must be an array of functions"));
if(!f.length)return n();var a=function(f){return function(q){if(q)n.apply(null,arguments),n=function(){};else{var c=Array.prototype.slice.call(arguments,1),t=f.next();t?c.push(a(t)):c.push(n);f.apply(null,c)}}};a(I.iterator(f))()}}};var a=Brid.Util,F=Brid.event,c=Brid.AdSDK.Util,u=c.VAST,R=c.async,I=c.basync,P=a.$f;Brid.AdSDK.XML={strToXMLDoc:function(f){new DOMParser;return f},isISO8601:function(f){isNaN(f)||(f+="");return"string"!=typeof f?!1:/^([\+-]?\d{4}(?!\d{2}\b))((-?)((0[1-9]|1[0-2])(\3([12]\d|0[1-9]|3[01]))?|W([0-4]\d|5[0-2])(-?[1-7])?|(00[1-9]|0[1-9]\d|[12]\d{2}|3([0-5]\d|6[1-6])))([T\s]((([01]\d|2[0-3])((:?)[0-5]\d)?|24\:?00)([\.,]\d+(?!:))?)?(\17[0-5]\d([\.,]\d+)?)?([zZ]|([\+-])([01]\d|2[0-3]):?([0-5]\d)?)?)?)?$/.test(a.trim(f))},
parseText:function(f){return/^\s*$/.test(f)?null:/^(?:true|false)$/i.test(f)?"true"===f.toLowerCase():isFinite(f)?parseFloat(f):e.isISO8601(f)?new Date(f):a.trim(f)},toJXONTree:function(f){f=e.strToXMLDoc(f);return new e.JXONTree(f)},keyValue:function(f){if(f)return f.keyValue},attr:function(f,n){if(f)return f["@"+c.decapitalize(n)]},encode:function(f){return f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},decode:function(f){return f.replace(/&apos;/g,
"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&")}};var e=Brid.AdSDK.XML;e.JXONTree=function(f){if(f.documentElement)return new e.JXONTree(f.documentElement);if(f.hasChildNodes()){for(var n="",q,t,v=0;v<f.childNodes.length;v++)(q=f.childNodes.item(v),3===(q.nodeType-1|1))?n+=3===q.nodeType?a.trim(q.nodeValue):q.nodeValue:1!==q.nodeType||q.prefix?1===q.nodeType&&"vmap"==q.prefix&&(t=c.decapitalize(q.nodeName.replace("vmap:","")),q=new e.JXONTree(q),this.hasOwnProperty(t)?
(c.isArray(this[t])||(this[t]=[this[t]]),this[t].push(q)):this[t]=q):(t=c.decapitalize(q.nodeName),q=new e.JXONTree(q),this.hasOwnProperty(t)?(c.isArray(this[t])||(this[t]=[this[t]]),this[t].push(q)):this[t]=q);n&&(this.keyValue=e.parseText(n))}if("undefined"===typeof f.hasAttributes?0<f.attributes.length:f.hasAttributes())for(t=0;t<f.attributes.length;t++)n=f.attributes.item(t),this["@"+c.decapitalize(n.name)]=e.parseText(n.value.trim())};e.JXONTree.prototype.attr=function(f){return this["@"+c.decapitalize(f)]};
var W=Brid.Button.extend({enabled:!1,default:{title:"Skip Ad"},init:function n(a,c){n.base.call(this,a,c);a.add("timeupdate",this.$f(this.updateSkipButtonState));this.toggleListeners(!1)},createElement:function q(){return q.base.call(this,"div",{className:"brid-iab-skip-button brid-button"})},onClick:function(){this.enabled&&this.trigger("skip")},updateSkipButtonState:function(){var a=Math.ceil(this.config.skipOffset-this.player.currentTime());0<a?this.el.innerHTML="SKIP IN "+Math.round(a)+"...":
this.enabled||(this.toggleListeners(!0),this.enabled=!0,this.el.innerHTML="SKIP AD")},destroy:function t(){this.player.remove("timeupdate",this.$f(this.updateSkipButtonState));t.base.call(this)}}),X=Brid.Sprite.extend({enabled:!1,init:function ca(a,c){ca.base.call(this,a,c);this.el.href=this.generateClickThroughURL(c.clickThrough,c.mediaFile.src);"string"===typeof c.clickThrough&&(this.el.target="_blank");this.add("click",this.$f(this.onClick))},createElement:function da(){return da.base.call(this,
"a",{className:"brid-iab-blocker"})},onClick:function(){this.trigger("clickthrough")},generateClickThroughURL:function(a,c){c={ASSETURI:c,CONTENTPLAYHEAD:u.formatProgress(1E3*this.player.currentTime())};return a?u.parseURLMacro(a,c):"#"}}),ja=X.extend({enabled:!1,init:function ea(a,b){ea.base.call(this,a,b)},createElement:function(){var c=a.createElement("a",{className:"brid-static-container"});-1!=this.config.mediaFile.type.indexOf("image/")&&(this.image=a.createElement("img",{src:this.config.mediaFile.src}),
this.image.onload=this.$f(function(){this.trigger("loaded")}),c.appendChild(this.image));return c},resize:function(a,c,b,p){this.el.style.top=a+"px";this.el.style.left=c+"px";this.el.style.width=b+"px";this.el.style.height=p+"px";this.el.style.setProperty("display","block","important")}}),S={html5:"text/javascript text/javascript1.0 text/javascript1.2 text/javascript1.4 text/jscript application/javascript application/x-javascript text/ecmascript text/ecmascript1.0 text/ecmascript1.2 text/ecmascript1.4 text/livescript application/ecmascript application/x-ecmascript".split(" ")},
J=Brid.PlaybackTech.extend({init:function(a){this.config=a;this.name="AdSDK.VideoSlot";this.el=this.createElement();this.hide();this.triggerReady()},destroy:function(){this.el.parentNode.removeChild(this.el)},createElement:function(){var c=this.config,e=a.createElement("video",{id:c.id,className:"brid-tech"});e.preload="none";a.autoplaySupported&&(c.autoplay||c.play_in_page)&&(e.setAttribute("muted","true"),e.muted=!0);if(c.inpage_mobile||c.play_in_page)e.setAttribute("webkit-playsinline",""),e.setAttribute("playsinline",
"");return e},hide:function fa(){fa.base.call(this)},show:function b(){b.base.call(this)},play:function(){this.el.play()},pause:function(){this.el.pause()},paused:function(){return this.el.paused},currentTime:function(){return this.el.currentTime},setCurrentTime:function(b){try{this.el.currentTime=b}catch(p){Brid.warn("--- BridPlayer --- Video isn't ready. ",p)}},duration:function(){return this.el.duration||0},buffered:function(){return this.el.buffered},volume:function(){return this.el.volume},setVolume:function(b){this.el.volume=
b},muted:function(){return this.el.muted},setMuted:function(b){b||this.el.removeAttribute("muted");this.el.muted=b},src:function(b){this.el.src=b},load:function(){this.el.load()},currentSrc:function(){return this.el.src},preload:function(){return this.el.preload},setPreload:function(b){this.el.preload=b},autoplay:function(){return this.el.autoplay},setAutoplay:function(b){this.el.autoplay=b},loop:function(){return this.el.loop},setLoop:function(b){this.el.loop=b},error:function(){switch(this.el.error.code){case 1:return"Fetching process aborted by user";
case 2:return"Error occurred when downloading";case 3:return"Error occurred when decoding";case 4:return"Audio/video not supported"}return!1},networkState:function(){return this.el.networkState},readyState:function(){return this.el.readyState},seeking:function(){return this.el.seeking},ended:function(){return this.el.ended},defaultMuted:function(){return this.el.defaultMuted}});J.isSupported=function(){return!!E.createElement("video").canPlayType};J.canPlaySource=function(b){return(b=a.formatType(b.src,
b.type))?E.createElement("video").canPlayType?!!E.createElement("video").canPlayType(b):!1:!1};J.canPlayURL=function(b){return(b=a.getTypeFromFile(b))?E.createElement("video").canPlayType?!!E.createElement("video").canPlayType(b):!1:!1};J.events="loadstart suspend abort error emptied stalled loadedmetadata loadeddata canplay canplaythrough playing waiting seeking seeked ended durationchange timeupdate progress play pause ratechange volumechange webkitbeginfullscreen webkitendfullscreen".split(" ");
J.prototype.support={fullscreen:a.ua.match("Chrome")||a.ua.match("Mac OS X 10.5")?!1:!0,movingElementInDOM:!a.isIOS(),progressEvent:!0,timeupdateEvent:!0,monetizable:!0,adManagement:!1,canResize:!0,hasPoster:!1,qualityManager:!1};a.isAndroid()&&3>a.androidVersion()&&(E.createElement("video").constructor.prototype.canPlayType=function(b){return b&&-1!=b.toLowerCase().indexOf("video/mp4")?"maybe":""});var Y=Brid.Class.extend({init:function(b){this.id=b.attr("id");this.sequence=b.attr("sequence");b.inLine&&
(this.inLine=new ka(b.inLine));b.wrapper&&(this.wrapper=new la(b.wrapper))}}),ga=Brid.Class.extend({init:function(b){this.id=b.attr("id");this.sequence=b.attr("sequence");this.adId=b.attr("adId")||b.attr("adID");this.apiFramework=b.attr("apiFramework");b.linear?this.linear=new ma(b.linear):b.nonLinearAds&&(this.nonLinearAds=new na(b.nonLinearAds))}}),ha=Brid.Class.extend({init:function(b){this.type=b.attr("type");b.customTracking&&b.customTracking.tracking&&(this.trackingEvents=u.parseTrackingEvents(b.customTracking.tracking))}}),
ka=Brid.Class.extend({init:function(b){this.adTitle=e.keyValue(b.adTitle);this.adSystem=e.keyValue(b.adSystem);this.impressions=u.parseImpressions(b.impression);this.creatives=u.parseCreatives(b.creatives);this.description=e.keyValue(b.description);this.advertiser=e.keyValue(b.advertiser);this.surveys=function(b){return b?c.transformArray(c.isArray(b)?b:[b],function(b){if(b.keyValue)return{uri:b.keyValue,type:b.attr("type")}}):[]}(b.survey);this.error=e.keyValue(b.error);this.pricing=e.keyValue(b.pricing);
b.extensions&&(this.extensions=u.parseExtensions(b.extensions))}}),ma=Brid.Class.extend({init:function(b){this.duration=u.parseTimeString(e.keyValue(b.duration));this.mediaFiles=function(b){var p=[];b&&(b=c.isArray(b)?b:[b],b.forEach(function(b){p.push(new oa(b))}));return p}(b.mediaFiles&&b.mediaFiles.mediaFile);this.trackingEvents=u.parseTrackingEvents(b.trackingEvents&&b.trackingEvents.tracking,this.duration);this.skipoffset=u.parseOffset(e.attr(b,"skipoffset"),this.duration);b.videoClicks&&(this.videoClicks=
new pa(b.videoClicks));b.adParameters&&(this.adParameters=e.keyValue(b.adParameters),e.attr(b.adParameters,"xmlEncoded")&&(this.adParameters=e.decode(this.adParameters)))}}),na=Brid.Class.extend({init:function(b){this.trackingEvents=u.parseTrackingEvents(b.trackingEvents&&b.trackingEvents.tracking);b.nonLinear&&(this.nonLinear=new qa(b.nonLinear))}}),qa=Brid.Class.extend({init:function(b){b.staticResource&&(this.type=b.staticResource.attr("creativeType"),this.src=e.keyValue(b.staticResource));this.clickThrough=
e.keyValue(b.nonLinearClickThrough);this.clickTrackings=function(b){var p=[];b&&(b=c.isArray(b)?b:[b],b.forEach(function(b){p.push(e.keyValue(b))}));return p}(b.nonLinearClickTracking);this.width=b.attr("width");this.height=b.attr("height");this.minSuggestedDuration=b.attr("minSuggestedDuration");this.apiFramework=b.attr("apiFramework");this.id=b.attr("id");this.scalable=b.attr("scalable");this.maintainAspectRatio=b.attr("maintainAspectRatio")}}),oa=Brid.Class.extend({init:function(b){this.src=e.keyValue(b);
this.delivery=b.attr("delivery");this.type=b.attr("type");this.width=b.attr("width");this.height=b.attr("height");this.codec=b.attr("codec");this.id=b.attr("id");this.bitrate=b.attr("bitrate");this.minBitrate=b.attr("minBitrate");this.maxBitrate=b.attr("maxBitrate");this.scalable=b.attr("scalable");this.maintainAspectRatio=b.attr("maintainAspectRatio");this.apiFramework=b.attr("apiFramework")}}),ia=Brid.Class.extend({init:function(b,p){this.name=b.attr("event");this.uri=e.keyValue(b);"progress"===
this.name&&(this.offset=u.parseOffset(b.attr("offset"),p))}}),pa=Brid.Class.extend({init:function(b){function p(b){var p=[];b&&(b=c.isArray(b)?b:[b],b.forEach(function(b){p.push(e.keyValue(b))}));return p}this.clickThrough=e.keyValue(b.clickThrough);this.clickTrackings=p(b.clickTracking);this.customClicks=p(b.customClick)}}),la=Brid.Class.extend({init:function(b){this.adSystem=e.keyValue(b.adSystem);this.impressions=u.parseImpressions(b.impression);this.VASTAdTagURI=e.keyValue(b.vASTAdTagURI);this.creatives=
u.parseCreatives(b.creatives);this.error=e.keyValue(b.error);this.extensions=b.extensions;this.followAdditionalWrappers="undefined"!=typeof e.attr(b,"followAdditionalWrappers")?e.attr(b,"followAdditionalWrappers"):!0;this.allowMultipleAds=e.attr(b,"allowMultipleAds");this.fallbackOnNoAd=e.attr(b,"fallbackOnNoAd")}}),Z=Brid.Class.extend({init:function(b){this.breakId=b.attr("breakId");this.breakType=b.attr("breakType");this.timeOffset=b.attr("timeOffset");-1!=this.timeOffset.indexOf(":")&&(this.timeOffset=
c.VAST.parseTimeString(this.timeOffset));this.played=!1;if(b.adSource||b.ad)this.adSource=new ra(b.adSource||b.ad);b.trackingEvents&&(this.trackingEvents=u.parseTrackingEvents(b.trackingEvents))}}),ra=Brid.Class.extend({init:function(b){b.adTagURI||b.vastAdData||b.customData?(this.id=b.attr("id"),this.allowMultipleAds=b.attr("allowMultipleAds"),this.followRedirects=b.attr("followRedirects"),b.adTagURI&&(this.adTagURI=e.keyValue(b.adTagURI),this.templateType=b.adTagURI.attr("templateType")),b.vastAdData&&
(this.vastAdData=e.keyValue(b.vastAdData),this.templateType="vast3"),b.customData&&(this.customData=e.keyValue(b.customData),this.templateType=b.adTagURI.attr("templateType"))):this.adTagURI=e.keyValue(b)}}),v=function(b,p,a){this.message="Brid AdSDK VAST Error: "+(b||"")+" "+(p||"");a&&(this.data=a);p&&(this.code=p)};v.prototype=Error();v.prototype.name="VAST Error";var N=Brid.Class.extend({events:[],init:function(b,p){this.response=p;this.assetURI=b;this.progress=0;this.quartiles={firstQuartile:{tracked:!1,
time:Math.round(25*p.duration)/100*1E3},midpoint:{tracked:!1,time:Math.round(50*p.duration)/100*1E3},thirdQuartile:{tracked:!1,time:Math.round(75*p.duration)/100*1E3}}},trackURLs:function(b,p){c.isArray(b)&&0<b.length&&(p=a.merge({ASSETURI:this.assetURI,CONTENTPLAYHEAD:u.formatProgress(this.progress)},p||{}),u.track(b,p))},trackEvent:function(b,p,a){a=a||this.response;var c=function(b){if(b){var p=[];b.forEach(function(b){p.push(b.uri)})}return p}(a.trackingEvents[b]);this.trackURLs(c);p&&delete a.trackingEvents[b]},
addTrackEvent:function(b,p,a){this.response.trackingEvents[b]&&a&&this.events.push({name:b,trackOnce:!!p})},addQuartileEvents:function(b){var p=this.quartiles.midpoint,a=this.quartiles.thirdQuartile;this.quartiles.firstQuartile.tracked?p.tracked?a.tracked||this.trackQuartile("thirdQuartile",b):this.trackQuartile("midpoint",b):this.trackQuartile("firstQuartile",b)},trackQuartile:function(b,p){var a=this.quartiles[b],c=a.time;p>=c&&p<=c+5E3&&(F.trigger(this,b),a.tracked=!0,this.addTrackEvent(b,!0,!0))},
directTrackQuartile:function(b,p){if(p=this.quartiles[b])p.tracked=!0,this.trackEvent(b,!0)},trackProgressEvents:function(b){var p=this.response.trackingEvents;if(c.isArray(p.progress)){var a=[];p.progress.forEach(P(this,function(p){p.offset<=b?this.trackURLs([p.uri]):a.push(p)}));p.progress=a}},trackEvents:function(){this.events.forEach(function(b){this.trackEvent(b.name,b.trackOnce)},this)},trackStart:function(){this.trackEvent("start",!0)},trackPause:function(){this.trackEvent("pause")},trackResume:function(){this.trackEvent("resume")},
trackSkip:function(){this.trackEvent("skip",!0)},trackFullscreen:function(){this.trackEvent("fullscreen",!0)},trackExitFullscreen:function(){this.trackEvent("exitFullscreen",!0)},trackProgress:function(b,p){function a(p,a){return p>b&&3E3<Math.abs(a-p)}this.events=[];isNaN(b)||(this.addTrackEvent("start",!0,0<b),this.addTrackEvent("rewind",!1,a(this.progress,b)),p||this.addQuartileEvents(b),this.trackProgressEvents(b),this.trackEvents(),this.progress=b)},trackComplete:function(){this.quartiles.thirdQuartile.tracked&&
this.trackEvent("complete",!0)},trackErrorWithCode:function(b){isNaN(b)||this.trackURLs(this.response.errorURLMacros,{ERRORCODE:b})},trackImpressions:function(){this.trackURLs(this.response.impressions)},trackCreativeView:function(){this.trackEvent("creativeView")},trackClick:function(){this.trackURLs(this.response.clickTrackings)}});"rewind fullscreen exitFullscreen pause resume mute unmute acceptInvitation acceptInvitationLinear collapse expand".split(" ").forEach(function(b){N.prototype["track"+
a.uc(b)]=function(){this.trackEvent(b)}});["start","skip","close","closeLinear"].forEach(function(b){N.prototype["track"+a.uc(b)]=function(){this.trackEvent(b,!0)}});["firstQuartile","midpoint","thirdQuartile"].forEach(function(b){N.prototype["track"+a.uc(b)]=function(){this.quartiles[b].tracked=!0;this.trackEvent(b,!0)}});var sa=Brid.Class.extend({init:function(){this.nonLinearAdded=this.linearAdded=!1;this.nonLinear=void 0;this.ads=[];this.errorURLMacros=[];this.impressions=[];this.clickTrackings=
[];this.customClicks=[];this.trackingEvents={};this.mediaFiles=[];this.extensions=[];this.clickThrough=void 0;this.adSystem=this.creativeID=this.id=this.adTitle="";this.skipoffset=this.duration=void 0},addAd:function(b){if(b instanceof Y){var p=b.inLine;var a=b.wrapper;this.ads.push(b);p&&this._addInLine(p);a&&this._addWrapper(a);this._addID(b.id)}},_addErrorTrackUrl:function(b){(b=b instanceof e.JXONTree?e.keyValue(b):b)&&this.errorURLMacros.push(b)},_addImpressions:function(b){c.isArray(b)&&a.appendToArray(this.impressions,
b)},_addClickThrough:function(b){b&&(this.clickThrough=b)},_addClickTrackings:function(b){c.isArray(b)&&a.appendToArray(this.clickTrackings,b)},_addCustomClicks:function(b){c.isArray(b)&&a.appendToArray(this.customClicks,b)},_addTrackingEvents:function(b){var a=this.trackingEvents;b&&(b=c.isArray(b)?b:[b],b.forEach(function(b){a[b.name]||(a[b.name]=[]);a[b.name].push(b)}))},_addTitle:function(b){b&&(this.adTitle=b)},_addID:function(b){b&&(this.id=b)},_addAdSystem:function(b){this.adSystem=b},_addCreativeID:function(b){b&&
(this.creativeID=b)},_addDuration:function(b){isNaN(b)||(this.duration=b)},_addVideoClicks:function(b){b&&(this._addClickThrough(b.clickThrough),this._addClickTrackings(b.clickTrackings),this._addCustomClicks(b.customClicks))},_addMediaFiles:function(b){c.isArray(b)&&a.appendToArray(this.mediaFiles,b)},_addSkipoffset:function(b){b&&(this.skipoffset=b)},_addNonLinear:function(b){b&&(this.nonLinear=b,this._addClickThrough(b.clickThrough),this._addClickTrackings(b.clickTrackings))},_addAdParameters:function(b){b&&
(this.adParameters=b)},_addLinear:function(b){this._addDuration(b.duration);this._addTrackingEvents(b.trackingEvents);this._addVideoClicks(b.videoClicks);this._addMediaFiles(b.mediaFiles);this._addSkipoffset(b.skipoffset);this._addAdParameters(b.adParameters);this.linearAdded=!0},_addNonLinearAds:function(b){this._addTrackingEvents(b.trackingEvents);this._addNonLinear(b.nonLinear);this.nonLinearAdded=!0},_addExtensions:function(b){b.forEach(P(this,function(b){"activeview"==b.type&&b.trackingEvents&&
this._addTrackingEvents(b.trackingEvents)}))},_addInLine:function(b){this._addTitle(b.adTitle);this._addErrorTrackUrl(b.error);this._addImpressions(b.impressions);b.adSystem&&this._addAdSystem(b.adSystem);b.extensions&&this._addExtensions(b.extensions);b.creatives.forEach(P(this,function(b){b.linear?(this._addLinear(b.linear),this._addCreativeID(b.id||b.adId)):b.nonLinearAds&&this._addNonLinearAds(b.nonLinearAds)}))},_addWrapper:function(b){this._addErrorTrackUrl(b.error);this._addImpressions(b.impressions);
b.creatives.forEach(P(this,function(b){if(b=b.linear)this._addVideoClicks(b.videoClicks),this.clickThrough=void 0,this._addTrackingEvents(b.trackingEvents)}))},hasLinear:function(){return this.linearAdded}}),ta=Brid.Class.extend({init:function(){this.adBreaks=[]},addAdBreak:function(b){b instanceof Z&&this.adBreaks.push(b)},prerollAdBreaks:function(){var b=[];this.adBreaks.map(function(a){a.played||0!=a.timeOffset&&"start"!=a.timeOffset&&"0%"!=a.timeOffset||b.push(a)});return 0<b.length?b:null},postrollAdBreaks:function(){var b=
[];this.adBreaks.map(function(a){a.played||"end"!=a.timeOffset&&"100%"!=a.timeOffset||b.push(a)});return 0<b.length?b:null},midrollAdBreaks:function(){var b=[];this.adBreaks.map(function(a){var c=a.timeOffset;!a.played&&"end"!=c&&"100%"!=c&&0<c&&"start"!=c&&"0%"!=c&&b.push(a)});return 0<b.length?b:null},hasLinear:function(){return!0}}),ua=Brid.Sprite.extend({default:{responseTimeout:15E3,adsEnabled:!0},init:function p(a,c,e,z,h){p.base.call(this,a,z,h);this.playbackTech=e;this.viewMode="normal";this.adsManager=
c;this.container=h;this.adsCanceled=!1},playAd:function(a){var c;if(!this.adsCanceled){a||this.trackError(new v("On AdsManager, missing required VASTResponse"),a);a.linearAdded?c=[function(c){c(null,a)},this.$f(this._selectAdSource),this.$f(this._createVASTTracker),this.$f(this._addClickThrough),this.$f(this._addSkipButton),this.$f(this._addEvents),this.$f(this._playSelectedAd)]:a.nonLinearAdded&&(c=[function(c){c(null,a)},this.$f(this._selectAdSource),this.$f(this._createVASTTracker),this.$f(this._addEvents),
this.$f(this._playSelectedAd)]);R.waterfall(c,this.$f(function(a,c){a&&c?this.trackError(a,c):this.adsManager.isLinear()&&(this.adsManager.trigger("vast.adVideoComplete"),this.adsManager.trigger("vast.contentResumeRequested"),this.adsManager.trigger("vast.adEnd"))}));var p=this;return this._adUnit={_src:null,type:"VAST",pauseAd:function(){p.playbackTech.pause()},resumeAd:function(){p.playbackTech.play()},isPaused:function(){return p.playbackTech.paused()},getSrc:function(){return this._src},getWidth:function(){return this._width},
getHeight:function(){return this._height}}}},stopAd:function(){this.adsManager.trigger("vast.adEnd")},reset:function(){this.adsCanceled=!0;this.adsLoader=null},_selectAdSource:function(p,e){var D=this.player,G=D.adsManager.flagOurAd,z=D.config.Partner.id,h=D.el.offsetWidth;if(p.linearAdded){p.mediaFiles.sort(function(d,g){return Math.abs(h-d.width)-Math.abs(h-g.width)});for(var k=0,d=p.mediaFiles.length;k<d;k++){var g=p.mediaFiles[k];var l="video/ogg"===a.formatType(g.src,g.type);if("ogv"===D.techName){if(l){g.mp3=
g.src.replace("ogg","mp3").replace("mobile","mp3");break}}else if(J.canPlaySource(g))break;g=null}"ogv"!==D.techName||g||((g=c.getOGG(p.mediaFiles,!1,p,G,z))||(g=c.getOGG(p.mediaFiles,!0,p,G,z)),g&&!0!==g&&(this.playbackTech=D.tech,this.adsManager.trigger("vast.selected3rdParty")))}else p.nonLinearAdded&&h>=p.nonLinear.width&&(g=p.nonLinear);if(g&&1!=g)return g.duration=p.duration,this._adUnit&&(this._adUnit._src=g.src,this._adUnit._width=g.width,this._adUnit._height=g.height),e(null,g,p);p.linearAdded?
e(new v("Could not find Ad mediafile supported by this player",403),p):p.nonLinearAdded&&e(new v("Player to small for non linear ad to display",403),p)},_createVASTTracker:function(a,c,e){try{this.tracker=new N(a.src,c),e(null,a,this.tracker,c)}catch(H){e(H,c)}},_addEvents:function(a,c,e,v){function p(){.1>Math.abs(l.duration())-l.currentTime()||(c.trackPause(),this.adsManager.trigger("vast.adPause"),l.addOnce("play",this.$f(function(){c.trackResume();this.adsManager.trigger("vast.adResume")})))}
function h(){var d=1E3*l.currentTime();c.trackProgress(d)}function k(){var d=l.muted();d?c.trackMute():g&&c.trackUnmute();g=d}function d(d){this.adsManager.trigger("vast."+d.type)}var g,l=this.playbackTech;e.linearAdded&&(l.add("pause",this.$f(p)),l.add("volumechange",k),l.add("timeupdate",h),F.add(c,["firstQuartile","midpoint","thirdQuartile"],this.$f(d)));this.adsManager.addOnce("vast.adStart",this.$f(function(){c.trackImpressions();c.trackCreativeView();this.adsManager.trigger("vast.adImpression")}));
this.adsManager.addOnce(["vast.adEnd","vast.adsCancel","vast.adSkip"],this.$f(function(d){l.remove("pause",p);l.remove("timeupdate",h);l.remove("volumechange",k);l!=this.player.tech&&(l.src(""),l.hide());"vast.adEnd"===d.type&&c.trackComplete()}));return v(null,a,e)},_addSkipButton:function(a,c,e,v){function p(){h&&(this.removeChild(h),h.destroy(),h=null)}if(!e.nonLinearAdded&&!isNaN(e.skipoffset)){var h=new W(this.player,{skipOffset:e.skipoffset});h.add("skip",this.$f(function(){c.trackSkip();this.adsManager.trigger("vast.adSkip")}));
this.addChild(h);this.adsManager.addOnce(["vast.adEnd","vast.adsCancel","vast.adSkip"],this.$f(p))}v(null,a,c,e)},_addClickThrough:function(a,c,e,v){var p=this.playbackTech,h=new X(this.player,{clickThrough:e.clickThrough,mediaFile:a});h.add("clickthrough",function(){c.trackClick();if(p.paused())return p.play(),!1;p.pause()});this.addChild(h);this.adsManager.addOnce(["vast.adEnd","vast.adsCancel","vast.adSkip"],this.$f(function(){h&&(this.removeChild(h),h.destroy(),h=null)}));return v(null,a,c,e)},
_playSelectedAd:function(a,c,e){function p(){h.remove(["play","playing"],this.$f(p));k.trigger("vast.adStart")}var z=this.player,h=this.playbackTech,k=this.adsManager;if(c.linearAdded)k.trigger("vast.contentPauseRequested"),h.show(),h.addOnce(["loadedmetadata","error"],this.$f(function(d){"loadedmetadata"===d.type?(h.addOnce("ended",function(){e(null,c)}),h.addOnce(["play","playing"],this.$f(p)),k.addOnce("vast.adSkip",function(){e(null,c)}),h.play()):"error"===d.type&&e(new v("on VASTManager, Player is unable to play the Ad",
400),c)})),h.src("ogv"===z.techName?a:a.src),z.canAutoplay()||z.userInteracted?h.load():e(new v("Playback attempted without user interaction on environment that does not support video playback without user interaction"),c);else if(c.nonLinearAdded){var d=this.nonLinear=new ja(z,{clickThrough:c.clickThrough,mediaFile:a});d.add("loaded",this.$f(function(){k.trigger("vast.adStart")}));this.addChild(d);k.trigger("vast.contentResumeRequested");k.addOnce(["vast.adEnd","vast.adsCancel"],this.$f(function(){d&&
(this.removeChild(d),d.destroy(),this.nonLinear=d=null)}))}},getAdDuration:function(){return this.playbackTech.duration()},getAdCurrentTime:function(){return this.playbackTech.currentTime()},setAdVolume:function(a){this.playbackTech.setVolume(a);this.playbackTech.setMuted(!a)},getAdVolume:function(){return this.playbackTech.volume()},stop:function(){this.adsManager.trigger("vast.contentResumeRequested");this.adsManager.trigger("vast.adSkip")},resize:function(a,c,e,v,z){this.nonLinear&&this.nonLinear.resize(a,
c,e,v);this.tracker&&this.viewMode!==z&&(this.viewMode=z,"fullscreen"===z?this.tracker.trackFullscreen():this.tracker.trackExitFullscreen())},trackError:function(a,c){this.tracker?this.tracker.trackErrorWithCode(a.code||900):c&&u.track(c.errorURLMacros,{ERRORCODE:a.code||900});this.adsManager.adError(a,c)},addChild:function G(a){G.base.call(this,a);this.container.appendChild(a.el)},removeChild:function D(a){a.el&&this.container.removeChild(a.el);D.base.call(this,a)}}),O="handshakeVersion initAd startAd stopAd skipAd resizeAd pauseAd resumeAd expandAd collapseAd subscribe unsubscribe".split(" "),
A=Brid.Class.extend({init:function(a,c,e){},handshakeVersion:function(a,c){},initAd:function(a,c,e,h,k,d,g){},startAd:function(a){},stopAd:function(a){},skipAd:function(a){},resizeAd:function(a,c,e,h){},pauseAd:function(a){},resumeAd:function(a){},expandAd:function(a){},collapseAd:function(a){},add:function(a,c,e){},remove:function(a,c){},removeAll:function(){F.removeAll(this)},getAdLinear:function(a){},getAdWidth:function(a){},getAdHeight:function(a){},getAdExpanded:function(a){},getAdSkippableState:function(a){},
getAdRemainingTime:function(a){},getAdDuration:function(a){},getAdVolume:function(a){},getAdCompanions:function(a){},getAdIcons:function(a){},setAdVolume:function(a,c){},addClass:function(c){a.addClass(this.el,c)},$f:function(c,e){return a.$f(this,c,e)}});L(A,"METHODS",O);L(A,"GETTERS","getAdLinear getAdWidth getAdHeight getAdExpanded getAdSkippableState getAdRemainingTime getAdDuration getAdVolume getAdCompanions getAdIcons".split(" "));L(A,"SETTERS",["setAdVolume"]);L(A,"EVENTS","AdLoaded AdStarted AdStopped AdSkipped AdSkippableStateChange AdSizeChange AdLinearChange AdDurationChange AdExpandedChange AdRemainingTimeChange AdVolumeChange AdImpression AdVideoStart AdVideoFirstQuartile AdVideoMidpoint AdVideoThirdQuartile AdVideoComplete AdInteraction AdUserAcceptInvitation AdUserMinimize AdUserClose AdPaused AdPlaying AdLog AdError".split(" "));
var va=O.filter(function(a){return-1===["skipAd"].indexOf(a)});L(A,"checkVPAIDInterface",function(a){return va.every(function(c){return"function"===typeof a[c]})});var wa=Brid.Sprite.extend({default:{},init:function H(a,h,k){H.base.call(this,a,h);this.response=h.response;this.vpaidManager=k;this.id="fakeVideoElement"},createElement:function z(){var h=z.base.call(this,"div",{src:"#"});h.HAVE_NOTHING=0;h.HAVE_METADATA=1;h.HAVE_CURRENT_DATA=2;h.HAVE_FUTURE_DATA=3;h.HAVE_ENOUGH_DATA=4;h.NETWORK_EMPTY=
0;h.NETWORK_IDLE=1;h.NETWORK_LOADING=2;h.NETWORK_NO_SOURCE=3;h.src="#";h.currentSrc="#";h.currentTime=0;h.buffered=a.createTimeRange(0,0);h.played=a.createTimeRange(0,0,0);h.volume=null;h.muted=null;h.duration=1;h.load=this.$f(this.load);h.play=this.$f(this.play);h.pause=this.$f(this.pause);h.readyState=0;h.ended=!1;h.paused=!1;a.css(h,{width:"100%",height:"100%"});h.canPlayType=function(h){return"video/mp4"==h?"probably":""};h.requestFullscreen=function(){};return h},load:function(){if(!this.videoPlaying){var e=
this.player,h=this.el,k;"undefined"!=typeof h&&h&&(k="#"!=h.src?h.src:h.getAttribute("src"))&&"#"!=k&&(k={src:k,type:-1!=k.indexOf("youtube.com")?"video/mp4":a.getTypeFromFile(k)},(k=c.getOGG([k],!0,this.response,e.adsManager.flagOurAd,e.config.Partner.id))&&1!=k?(e.adsManager.trigger("vast.selected3rdParty"),this.videoPlaying=!0,e.add("play",this.$f(this.onFakeEvent)),e.add("playing",this.$f(this.onFakeEvent)),e.add("pause",this.$f(this.onFakeEvent)),e.add("ended",this.$f(this.onFakeEvent)),e.add("loadedmetadata",
this.$f(this.onFakeEvent)),e.add("timeupdate",this.$f(this.onFakeEvent)),e.add("loadstart",this.$f(this.onFakeEvent)),e.add("waiting",this.$f(this.onFakeEvent)),e.add("progress",this.$f(this.onFakeEvent)),e.add("durationchange",this.$f(this.onFakeEvent)),e.add("volumechange",this.$f(this.onFakeEvent)),e.techCall("src",k),e.techCall("load"),e.techCall("play"),h.ended=!1,h.paused=!1,h.duration=e.techGet("duration"),h.readyState=1):this.vpaidManager._trackError(new v("Could not find Ad mediafile supported by this player",
403),this.response))}},play:function(){var a=this.player;this.videoPlaying?a.techCall("play"):this.load()},pause:function(){this.videoPlaying&&this.player.techCall("pause")},setVolume:function(a){this.player.techCall("setVolume",a)},onFakeEvent:function(a){if(this.el){var h=this.el,k=this.player;switch(a.type){case "progress":h.buffered=k.techGet("buffered");2>h.readyState?h.readyState=2:3>h.readyState&&(h.readyState=3);break;case "loadedmetadata":h.readyState=4;h.duration=k.techGet("duration");break;
case "timeupdate":h.currentTime=k.techGet("currentTime")||1;null!=h.volume&&h.volume!=k.techGet("volume")?this.player.techCall("setVolume",h.volume):null!=h.muted&&h.muted!=k.techGet("muted")&&this.player.techCall("setMuted",h.muted);break;case "play":h.duration=k.techGet("duration");h.paused=!1;break;case "pause":h.paused=!0;break;case "volumechange":h.volume=k.techGet("volume");break;case "ended":h.currentTime=h.duration,h.ended=!0,this.videoPlaying=!1}C.CustomEvent&&(a=new CustomEvent(a.type,{detail:{},
bubbles:!1,cancelable:!0}),h.dispatchEvent(a))}},destroy:function h(){var a=this.player;a.remove("play",this.$f(this.onFakeEvent));a.remove("playing",this.$f(this.onFakeEvent));a.remove("pause",this.$f(this.onFakeEvent));a.remove("ended",this.$f(this.onFakeEvent));a.remove("loadedmetadata",this.$f(this.onFakeEvent));a.remove("timeupdate",this.$f(this.onFakeEvent));a.remove("loadstart",this.$f(this.onFakeEvent));a.remove("waiting",this.$f(this.onFakeEvent));a.remove("progress",this.$f(this.onFakeEvent));
a.remove("durationchange",this.$f(this.onFakeEvent));a.remove("volumechange",this.$f(this.onFakeEvent));this.el&&(this.el.load=function(){},this.el.play=function(){},this.el.pause=function(){});h.base.call(this)}}),Q=Brid.Class.extend({default:{},init:function(a,k){if(!a||!Q.checkVPAIDInterface(a))throw new v("on VPAIDUnitWrapper, the passed VPAID adUnit does not fully implement the VPAID interface");if("object"!=typeof k)throw new v("on VPAIDUnitWrapper, expected config hash but got '"+k+"'");if(!("responseTimeout"in
k)||"number"!=typeof k.responseTimeout)throw new v("on VPAIDUnitWrapper, expected responseTimeout in options");this.config=k;this._adUnit=a},add:function(a,k){(this._adUnit.addEventListener||this._adUnit.subscribe||this._adUnit.on||this._adUnit.add).call(this._adUnit,a,k)},remove:function(a,k){(this._adUnit.removeEventListener||this._adUnit.unsubscribe||this._adUnit.off||this._adUnit.remove).call(this._adUnit,a,k)},trigger:function(a){this._adUnit.trigger(a)},handshakeVersion:function(a,k){this._adUnit.handshakeVersion(a,
k)},initAd:function(a,k,d,g,l,r,m){this._adUnit.initAd(a,k,d,g,l,r,m)},resizeAd:function(a,k,d,g){this._adUnit.resizeAd(a,k,d,g)},startAd:function(a,k){this._adUnit.startAd(a,k)},stopAd:function(a){this._adUnit.stopAd(a)},pauseAd:function(a){this._adUnit.pauseAd(a)},resumeAd:function(a){this._adUnit.resumeAd(a)},expandAd:function(a){this._adUnit.expandAd(a)},collapseAd:function(a){this._adUnit.collapseAd(a)},skipAd:function(a){this._adUnit.skipAd(a)},setAdVolume:function(a,k){this._adUnit.setAdVolume(a,
k)}});Q.checkVPAIDInterface=function(a){function k(a){return c.isFunction(a.unsubscribe)||c.isFunction(a.removeEventListener)||c.isFunction(a.off)||c.isFunction(a.remove)}for(var d="handshakeVersion initAd startAd stopAd resizeAd pauseAd expandAd collapseAd".split(" "),g=0,h=d.length;g<h;g++)if(!a||!c.isFunction(a[d[g]]))return!1;return function(a){return c.isFunction(a.subscribe)||c.isFunction(a.addEventListener)||c.isFunction(a.on)||c.isFunction(a.add)}(a)&&k(a)};"adLinear adWidth adHeight adExpanded adSkippableState adRemainingTime adDuration adVolume adCompanions adIcons".split(" ").forEach(function(h){var k=
"get"+a.uc(h);Q.prototype[k]=function(a){this._adUnit[k](a)}});var K=A.extend({init:function k(a,g,l,r){k.base.call(this,a,g,l);if(this.isValid=A.checkVPAIDInterface(a))this._creative=a,this.container=g,this._videoEl=l,this._iframe=r,this.addClass("brid-tech"),this._addEvents()},initAd:function(k,d,g,l,r,m,c){r=r||{};m=a.merge({slot:this.container,videoSlot:this._videoEl},m||{});try{this._creative.initAd(k,d,g,l,r,m)}catch(w){var x=w}c(x)},startAd:function(k,d){d&&a.autoplaySupported&&(d=this.container.getElementsByTagName("video"),
Array.prototype.forEach.call(d,function(a){a.setAttribute("muted","");a.muted=!0;a.setAttribute("autoplay","");a.autoplay=!0}));try{this._creative.startAd()}catch(l){var g=l}k(g)},resizeAd:function(k,d,g,l){a.css(this.container,{width:k+"px",height:d+"px"});try{this._creative.resizeAd(k,d,g)}catch(m){var r=m}l(r)},add:function(a,d){F.add(this,a,d)},remove:function(a,d){F.remove(this,a,d)},trigger:function(a,d,g){return F.trigger(this,a,d,g)},removeAll:function(){F.removeAll(this)},setAdVolume:function(a,
d){var g=null;try{this._creative.setAdVolume(a);var k=this._creative.getAdVolume()}catch(r){g=r}g||k!=a&&(g="failed to apply volume: "+a);d&&d(g,k)},destroy:function(){this.stopAd();this.removeAll();this._removeEvents();this._iframe=this._videoEl=this.container=this._creative=null},_addEvents:function(){A.EVENTS.forEach(function(a){this._creative.subscribe(this.trigger.bind(this,a),a)}.bind(this));this._creative.subscribe(this.$f(this._clickThruHook),"AdClickThru");if(this._videoEl){var a=this._iframe.contentDocument.documentElement,
d=this._videoEl;a.addEventListener("click",function(g){g.target===a&&d.click()})}},_removeEvents:function(){A.EVENTS.forEach(function(a){this._creative.unsubscribe(this.trigger.bind(this,a),a)}.bind(this));this._creative.unsubscribe(this.$f(this._clickThruHook),"AdClickThru")},_clickThruHook:function(a,d,g){F.trigger(this,"AdClickThru",{url:a,id:d,playerHandles:g})}});A.METHODS.forEach(function(a){-1==="add remove subscribe unsubscribe initAd startAd resizeAd".split(" ").indexOf(a)&&(K.prototype[a]=
function(){var d=A.prototype[a].length,g=Array.prototype.slice.call(arguments),d=g&&d===g.length?g.pop():void 0,k=null;try{var r=this._creative[a].apply(this._creative,g)}catch(m){k=m}d&&"function"==typeof d&&d(k,r)})});A.GETTERS.forEach(function(a){K.prototype[a]=function(d){var g=null;try{var k=this._creative[a]()}catch(r){g=r}d&&"function"==typeof d&&d(g,k)}});K.prototype.on=K.prototype.add;K.prototype.off=K.prototype.remove;C.MutationObserver=C.MutationObserver||C.WebKitMutationObserver||C.MozMutationObserver;
O=Brid.Class.extend({default:{template:'<!DOCTYPE html><html style="padding:0px;height:100%;width:100%;background:transparent;" lang="en"><head><meta charset="UTF-8"></head><body style="overflow:hidden;margin:0px;padding:0px;height:100%;width:100%;max-width:100%;"><script>console.log("LOAD VPAID JS", new Date().getTime());\x3c/script><script type="text/javascript" src="{{iframeURL_JS}}">\x3c/script><script type="text/javascript">window.parent.postMessage(\'{"event": "ready", "id": "{{iframeID}}"}\', \'{{origin}}\');\x3c/script></body></html>',
timeout:15E3},init:function(k,d,g){Brid.log("FIRE VPAIDHtml5Tech init",(new Date).getTime());if(!d||"string"!=typeof d.src)throw new v("on VPAIDHtml5Tech, invalid MediaFile");this.config=a.merge(a.deepCopy(this.default)||{},g);this.name="vpaid-html5";this.mediaFile=d;this.container=k;this._videoEl=g.videoEl.el||g.videoEl;this._id="vpaid_html5_"+a.nextID++;this._destroyed=!1;this._iframe=k.getElementsByClassName("brid-tech-iframe")[0];Brid.log("FIRE VPAIDHtml5Tech init finish",(new Date).getTime())},
_adDestroyed:function(){this._removeAdElements();delete this._adUnit},_removeAdElements:function(){if(this._frame){try{this.container.removeChild(this._frame)}catch(g){Brid.log("BRID ADSDK - IFRAME ALREADY REMOVED",g)}delete this._frame}if(this._destroyed)for(var a=this.container.childNodes,d=0;d<a.length;d++)"div"!==a[d].nodeName.toLowerCase()||""==a[d].id&&""==a[d].className||this.container.removeChild(a[d]);this._destroyLoadListener()},_unloadPreviousAdUnit:function(){this._removeAdElements();
this._destroyAdUnit()},_destroyLoadListener:function(){this._onLoad&&(V.removeEventListener("message",this._onLoad),c.clearCallbackTimeout(this._onLoad),delete this._onLoad)},_destroyAdUnit:function(){this._adUnit&&(this._adUnit.destroy(),delete this._adUnit)},destroy:function(){this._destroyed||(this._destroyed=!0,this.config.videoEl&&this.config.videoEl.destroy&&(this.config.videoEl.destroy(),this.config.videoEl=null),this._unloadPreviousAdUnit())},loadAdUnit:function(k){Brid.log("FIRE VPAIDHtml5Tech loadAdUnit",
(new Date).getTime());if(this._destroyed)Brid.error("VPAIDHTML5Tech already destroyed!");else{this._unloadPreviousAdUnit();this._onLoad=a.$f(this,c.callbackTimeout(this.config.timeout,a.$f(this,function(d){if(d.origin===a.getOrigin()||d.source==l.contentWindow){try{if(JSON.parse(d.data).id!==this._id)return}catch(w){return}var m;if(l.contentWindow){var r=l.contentWindow.getVPAIDAd;"function"!=typeof r&&(m="the ad didn't return a function to create an ad")}else m="the iframe is not anymore in the DOM tree";
if(!m){d=l.contentWindow.document.body;var c=new K(r(),d,g,l);c.add("AdStopped",a.$f(this,this._adDestroyed));c.isValid||(m="the add is not fully complaint with VPAID specification")}this._adUnit=c;this._destroyLoadListener();k(m,m?null:c);return!0}}),a.$f(this,function(){k(new v("Ad mediafile load timeout",402),null)})));V.addEventListener("message",this._onLoad);var d=this.mediaFile.src,g=this._videoEl;Brid.log("FIRE write iframe content",(new Date).getTime(),this._iframe);ba(this._iframe,aa(this.config.template,
a.merge({iframeURL_JS:d,iframeID:this._id,origin:a.getOrigin()},this.config.extraOptions)));this._iframe.setAttribute("SCROLLING","NO");var l=this._frame=this._iframe}}});O.supports=function(a){return-1<S.html5.indexOf(a)};u.VPAID_techs.push(O);var U=Brid.Sprite.extend({default:{responseTimeout:15E3,VPAID_VERSION:"2.0",preferredTech:"html5"},_isAdLoaded:!1,_adUnitEvents:"AdSkipped AdImpression AdDurationChange AdDurationChange AdStarted AdVideoStart AdPlaying AdPaused AdVideoFirstQuartile AdVideoMidpoint AdVideoThirdQuartile AdVideoComplete AdRemainingTimeChange AdClickThru AdUserAcceptInvitation AdUserClose AdUserMinimize AdError AdVolumeChange".split(" "),
init:function d(a,l,c,m,e){d.base.call(this,a,m);this.playbackTech=c;this.viewMode="normal";this.adsManager=l;this.container=e;this.impressionFired=this._destroyed=!1},playAd:function(a){function d(a,d,g){m.impressionFired||(a=new v("Ad is corrupted, impression not fired",402));g.linearAdded&&!a&&m.adsManager.trigger("vast.contentResumeRequested");m.trackTimeInterval&&clearInterval(m.trackTimeInterval);m.mediaTimeout&&clearTimeout(m.mediaTimeout);a&&g&&m._trackError(a,g);l()}function l(){e!=m.player.tech&&
(e.currentSrc()&&e.src(""),e.hide());setTimeout(function(){c.trigger("vast.adEnd")},0)}var c=this.adsManager,m=this,e=this.playbackTech;Brid.log("VPAIDManager.playAd looking for supported tech...");var x=this.tech=this._findSupportedTech(a,this.config);this._fakeAdUnit=null;this._adFinishCalled=this._adErrored=this._adStarted=!1;c.add("vast.adsCancel",l);c.addOnce(["vast.adEnd","vast.adError"],this.$f(function(){m.trackTimeInterval&&clearInterval(m.trackTimeInterval);m.mediaTimeout&&clearTimeout(m.mediaTimeout);
this._adStarted=!1;c.remove("vast.adsCancel",l);try{this.destroy()}catch(y){Brid.error("Brid AdSDK error removing VPAID",y)}}));if(x)Brid.log("VPAIDManager.playAd found tech: ",x,(new Date).getTime()),this._response=a,I.waterfall([function(d){d(null,x,a)},this.$f(this._loadAdUnit),this.$f(this._playAdUnit),this.$f(this._waitForAdEnd)],this.$f(function(a,g,m){d(a,g,m)}));else{Brid.error("VPAIDManager.playAd could not find suitable tech");var w=new v("on VPAIDManager.playAd, could not find a supported mediaFile",
403);d(w,this._fakeAdUnit,a);return null}this._remainingTime=this._duration=this._currentVolume=0;this._validRemainingTime=!0;return this._fakeAdUnit={_paused:!0,type:"VPAID",pauseAd:function(){m._pauseAdUnit()},resumeAd:function(){m._resumeAdUnit()},isPaused:function(){return m._paused},getSrc:function(){return x.mediaFile},getWidth:function(){return m._width},getHeight:function(){return m._height}}},_findSupportedTech:function(a,g){var d=this.player;if(!a)return null;var c=0<a.mediaFiles.length?
a.mediaFiles.filter(u.isVPAID):[a.nonLinear],m=g&&g.preferredTech,e=[],x,w;(a=this.videoEl="ogv"===d.techName?new wa(d,{response:a,timeout:g.responseTimeout},this):this.playbackTech.el)&&"fakeVideoElement"===a.id?this.addChild(a):this.playbackTech.show();g=0;for(d=c.length;g<d;g+=1){var y=c[g];if(x=u.findSupportedVPAIDTech(y.type)){if(w=m?y.type===m||S[m]&&-1<S[m].indexOf(y.type):!1)return Brid.log("BRID ADSKD cALL VPAIDTech",x),new x(this.container,y,{videoEl:a});e.push({mediaFile:y,tech:x})}}return e.length?
(c=e[0],new c.tech(this.container,c.mediaFile,{videoEl:a})):null},_createVPAIDAdUnitWrapper:function(a,g,c){return new Q(a,{src:g,responseTimeout:c})},_loadAdUnit:function(a,g,c){var d=this,m=this.config.responseTimeout;Brid.log("VPAIDManager _loadAdUnit",(new Date).getTime());a.loadAdUnit(function(l,r){if(l)return c(l,r,g);try{var e=d._createVPAIDAdUnitWrapper(r,a.mediaFile.src,m);c(null,e,g)}catch(y){c(y,r,g)}})},_playAdUnit:function(a,g,c){this._adUnit=a;g.linearAdded?this.adsManager.trigger("vast.contentPauseRequested"):
this.adsManager.trigger("vast.contentResumeRequested");I.waterfall([function(d){d(null,a,g)},this.$f(this._handshake),this.$f(this._initAd),this.$f(this._setupEvents),this.$f(this._startAd)],c)},_handshake:function(a,g,c){a.handshakeVersion(this.config.VPAID_VERSION,function(d,m){if(d)return c(d,a,g);if(d=m)d=m.split("."),d=parseInt(d[0],10),d=1<=d&&2>=d;return d?c(null,a,g):c(new v('on VPAIDManager._handshake, unsupported version "'+m+'"'),a,g)})},_initAd:function(a,g,c){function d(m){this._adErrored=
!0;a.remove("AdError",d);c(new v("on VPAIDManager, Ad unit dispatched an error event ",901,m),a,g)}var m=this.player;a.add("AdLoaded",this.$f(function(){this._isAdLoaded=!0}));a.add("AdError",this.$f(d));this.adsManager.addOnce("vast.adEnd",this.$f(function(){a.remove("AdError",d)}));a.initAd(m.el.offsetWidth,m.el.offsetHeight,U.VIEW_MODE.NORMAL,-1,{AdParameters:g.adParameters||""},"",function(d){c(d,a,g)})},_createVASTTracker:function(a,g){return new N(a,g)},_setupEvents:function(a,g,c){this.tracker=
this._createVASTTracker(a.config.src,g);this._adUnitEvents.forEach(this.$f(function(a){this._adUnit.add(a,this.$f(this._onAdUnitEvent))}));c(null,a,g)},_pauseAdUnit:function(){this._adUnit.pauseAd()},_resumeAdUnit:function(){this._adUnit.resumeAd()},_removeEvents:function(){this._adUnit&&this._adUnitEvents.forEach(this.$f(function(a){this._adUnit.remove(a,this.$f(this._onAdUnitEvent))}))},_onAdUnitEvent:function(d){function g(a){var d={ASSETURI:e.config.src,CONTENTPLAYHEAD:0};return a?u.parseURLMacro(a,
d):null}if(!this._destroyed){var c=this.tracker,r=this.player,m=this.adsManager,e=this._adUnit;switch(d.type){case "AdSkipped":m.trigger("vast.adSkip");c.trackSkip();break;case "AdImpression":Brid.log("AdSDK VPAIDManager on AdImpression");m.isSpringServe||(Brid.log("Fire impression on AdImpression"),this.impressionFired=!0,c.trackImpressions(),m.trigger("vast.adImpression"));break;case "AdDurationChange":a.throttle(this.$f(function(){e.getAdDuration(this.$f(function(a,d){this._duration=parseInt(a||
0>=d?this._response.duration:d);m.trigger("vast.adDurationChange")}))}),2E3,this);break;case "AdStarted":Brid.log("AdSDK VPAIDManager AdStarted");m.isSpringServe&&(Brid.log("Fire impression on AdStarted"),this.impressionFired=!0,c.trackImpressions(),m.trigger("vast.adImpression"));e.getAdDuration(this.$f(function(a,d){this._remainingTime=this._duration=parseInt(a||0>=d?this._response.duration:d);m.trigger("vast.adDurationChange")}));this.mediaTimeout&&clearTimeout(this.mediaTimeout);this.trackTimeInterval&&
clearInterval(this.trackTimeInterval);this.trackTimeInterval=setInterval(this.$f(function(){e.getAdRemainingTime(this.$f(function(a,d){a||isNaN(d)?this._validRemainingTime=!1:(this._validRemainingTime=!0,this._remainingTime=parseInt(d||this._duration))}))}),500);e.getAdWidth(this.$f(function(a,d){a||(this._width=d)}));e.getAdHeight(this.$f(function(a,d){a||(this._height=d)}));m.trigger("vast.adStart");this._paused=!1;this._adStarted=!0;c.trackCreativeView();break;case "AdVideoStart":m.trigger("vast.adVideoStart");
this._paused=!1;c.trackStart();break;case "AdPlaying":Brid.log("AdSDK VPAIDManager AdPlaying");m.trigger("vast.adResume");this._paused=!1;r.trigger("play");c.trackResume();break;case "AdPaused":m.trigger("vast.adPause");this._paused=!0;c.trackPause();break;case "AdVideoFirstQuartile":m.trigger("vast.firstQuartile");c.directTrackQuartile("firstQuartile",1E3*this.getAdCurrentTime());break;case "AdVideoMidpoint":m.trigger("vast.midpoint");c.directTrackQuartile("midpoint",1E3*this.getAdCurrentTime());
break;case "AdVideoThirdQuartile":m.trigger("vast.thirdQuartile");c.directTrackQuartile("thirdQuartile",1E3*this.getAdCurrentTime());break;case "AdVideoComplete":m.trigger("vast.adVideoComplete");c.trackComplete();break;case "AdRemainingTimeChange":this.trackTimeInterval&&clearInterval(this.trackTimeInterval);e.getAdRemainingTime(this.$f(function(a,d){a||isNaN(d)?this._validRemainingTime=!1:(this._validRemainingTime=!0,this._remainingTime=parseInt(d||this._duration))}));c.trackProgress(1E3*this.getAdCurrentTime(),
!0);break;case "AdClickThru":r=d.data;m.trigger("vast.adClickThru");d=r.url;r=r.playerHandles;d=d?d:g(this._response.clickThrough);c.trackClick();r&&d&&C.open(d,"_blank");break;case "AdUserAcceptInvitation":m.trigger("vast.adUserAcceptInvitation");break;case "AdUserMinimize":m.trigger("vast.adUserMinimize");break;case "AdVolumeChange":this._adStarted&&e.getAdVolume(this.$f(function(a,d){this._currentVolume!==d&&(0===d&&0<this._currentVolume&&c.trackMute(),0<d&&0===this._currentVolume&&c.trackUnmute(),
this._currentVolume=d,m.trigger("vast.adVolumeChange"))}))}}},_addSkipButton:function(a,g,c){function d(d){e=new W(d,{skipOffset:0});e.add("skip",l.$f(function(){a.skipAd();tracker.trackSkip();l.adsManager.trigger("vast.adSkip")}));l.addChild(e)}function m(){l.removeChild(e);e=null}var l=this,e,w=this.player;a.add("AdSkippableStateChange",function(){l.adsManager.trigger("vast.adSkippableStateChange");a.getAdSkippableState(function(a,g){g?e||d(w):m(w)})});this.addOnce(["vast.adEnd","vast.adsCancel"],
m);c(null,a,g)},_startAd:function(a,g,c){this.mediaTimeout&&clearTimeout(this.mediaTimeout);this.mediaTimeout=setTimeout(this.$f(this._onMediaTimeout),this.config.responseTimeout);if(this._isAdLoaded)this._adLoaded(a,g,c);else{try{this._hackVideoMuted(a),this._hackPlayButton(a)}catch(r){Brid.error("AdSDK VPAIDManager hack play button error",r)}a.add("AdLoaded",this.$f(function(){this._adLoaded(a,g,c)}))}},_onMediaTimeout:function(){this._trackError(new v("Ad mediafile load timeout",402),this._response)},
_adLoaded:function(d,g,c){var l=this.player;this.setAdVolume(l.values.muted?0:l.values.volume||0);a.isMobilePlatform()&&(this._hackVideoMuted(d),this._hackPlayButton(d));d.startAd(this.$f(function(a){c(null,d,g)}),l.config.autoplay)},_hackPlayButton:function(a){if(a=a._adUnit._iframe){var d=a.contentDocument?a.contentDocument:a.contentWindow.document,c=new CustomEvent("click",{bubbles:!0,cancelable:!0});d.body&&-1!=d.body.style.background.indexOf('url("data:image')&&d.body.dispatchEvent(c);Array.prototype.map.call(d.getElementsByTagName("svg"),
function(a){a.dispatchEvent(c)});Array.prototype.map.call(d.getElementsByClassName("play_overlay"),function(a){Array.prototype.map.call(d.getElementsByTagName("video"),function(d){!(d.src||d.children&&0!==d.children.length)&&3>d.readyState||a.dispatchEvent(c)})});Array.prototype.map.call(d.getElementsByTagName("video"),function(a){!(a.src||a.children&&0!==a.children.length)&&3>a.readyState||a.play()})}},_hackVideoMuted:function(d){function c(d){var c=d.play;if(d===e.videoEl||d.src||d.children&&0!==
d.children.length)-1===d.className.indexOf("brid")&&a.css(d,{"-webkit-transform":"translateX(1024px)"}),d.play=function(){function g(c){d.removeEventListener("play",g);a.css(d,{"-webkit-transform":"translateX(0)"})}d.muted=l.values.muted;d.play=c;d.addEventListener("error",function(a){});-1===d.className.indexOf("brid")&&d.addEventListener("play",g);setTimeout(function(){d.play()},200)}}var l=this.player,e=this;d=d._adUnit._iframe;Array.prototype.map.call((d.contentDocument?d.contentDocument:d.contentWindow.document).getElementsByTagName("video"),
c);Array.prototype.map.call(e.container.getElementsByTagName("video"),c)},_waitForAdEnd:function(a,c,l){function d(d){g._adFinishCalled||(this._adFinishCalled=!0,l(d,a,c))}var g=this;a.add("AdStopped",this.$f(function(){this._adErrored||(this.adsManager.trigger("vast.adStopped"),d(null))}));a.add("AdSkipped",this.$f(function(){this._adErrored||(this.adsManager.trigger("vast.adStopped"),d(null))}));a.add("AdUserClose",this.$f(function(){this._adErrored||(this.adsManager.trigger("vast.adUserClose"),
d(null))}))},_trackError:function(a,c){this.trackTimeInterval&&clearInterval(this.trackTimeInterval);u.track(c.errorURLMacros,{ERRORCODE:a.code||901});this.adsManager.adError(a,c)},stop:function(){this._adUnit.trigger("AdUserClose")},setAdVolume:function(a){if(this._adUnit){this._adUnit.setAdVolume(a);var d=this._adUnit._adUnit._iframe;d&&Array.prototype.map.call((d.contentDocument?d.contentDocument:d.contentWindow.document).getElementsByTagName("video"),function(d){d.muted=0===a})}this.videoEl&&
this.videoEl.el?this.videoEl.setVolume(a):this.videoEl&&(this.videoEl.muted=0===a)},getAdVolume:function(){return this._currentVolume||0},resize:function(d,c,l,e,m){var g=this;this._response.nonLinear?a.css(this.container,{top:d+"px",left:c+"px"}):a.css(this.container,{top:0,left:0,height:e+"px"});g._adUnit.resizeAd(l,e,m,function(a){a||(g._adUnit.getAdWidth(function(a,d){a||(g._width=d)}),g._adUnit.getAdHeight(function(a,d){a||(g._height=d)}))});g.tracker&&g.viewMode!==m&&(g.viewMode=m,"fullscreen"===
m?g.tracker.trackFullscreen():g.tracker.trackExitFullscreen())},getAdDuration:function(){return this._duration},getAdCurrentTime:function(){return this._validRemainingTime&&-.5<this._remainingTime&&this._remainingTime!=this._duration?this._duration-this._remainingTime:this.videoEl&&this.videoEl.currentTime},addChild:function g(a){g.base.call(this,a);this.container.appendChild(a.el)},removeChild:function l(a){this.container.removeChild(a.el);l.base.call(this,a)},destroy:function r(){this._isAdLoaded=
!1;this._destroyed=!0;this.trackTimeInterval&&clearInterval(this.trackTimeInterval);this.mediaTimeout&&clearTimeout(this.mediaTimeout);this._removeEvents();this.tech&&(this.tech.destroy(),this.tech=null);r.base.call(this)}});U.VIEW_MODE={NORMAL:"normal",FULLSCREEN:"fullscreen",THUMBNAIL:"thumbnail"};var ya=Brid.Class.extend({default:{WRAPPER_LIMIT:8},init:function(c,m){var e=a.deepCopy(this.default);this.config=a.merge(e||{},c);this.player=m;delete this.default;this.waterfallAds=[];this.errorURLMacros=
[];this._adChainFork=[]},getVASTResponse:function(a,m){function e(a,c){try{var m=r._buildVASTResponse(a);c(null,m)}catch(T){c(T)}}var r=this;"string"===typeof a||c.isFunction(a)?(r._adChainFork=[],r.waterfallAds=[],I.waterfall([this._getVASTAd.bind(this,a),e],m)):(0<r._adChainFork.length?(r._adChainFork[0].forkLength&&(r._adChainFork[0].forkLength--,0>=r._adChainFork[0].forkLength&&r._adChainFork.shift()),r._adChain=[].concat(r._adChainFork[0]||[])):r._adChain=[],I.waterfall([this._getAd.bind(this,
a,r._adChain),e],m))},_getVASTAd:function(a,m){function r(a,c){var m=[];try{a.forEach(function(a){m.push(new Z(a))}),c(null,m)}catch(T){c(new v("on AdsLoader._buildAd, error parsing VMAP",1002),null)}}var x=this;I.waterfall([this._requestVASTXml.bind(this,a),function(a,m){try{var r=x.vastTree=e.toJXONTree(a);if("undefined"!==typeof r.ad)r.ads=c.isArray(r.ad)?r.ad:[r.ad];else if("undefined"!==typeof r.adBreak)r.adBreaks=c.isArray(r.adBreak)?r.adBreak:[r.adBreak],delete r.adBreak;else if("undefined"!==
typeof r.preroll||"undefined"!==typeof r.postroll)r.adBreaks=[],"undefined"!==typeof r.preroll&&(r.preroll["@breakId"]="preroll",r.preroll["@breakType"]="linear",r.preroll["@timeOffset"]="start",r.adBreaks.push(r.preroll),delete r.preroll),"undefined"!==typeof r.postroll&&(r.postroll["@breakId"]="postroll",r.postroll["@breakType"]="linear",r.postroll["@timeOffset"]="end",r.adBreaks.push(r.postroll),delete r.postroll)}catch(T){m(new v("on AdsLoader._getVASTAd.buildVastWaterfall, error parsing xml",
100),null);return}m(x.validateVASTTree(r),r)}],function(a,e){function w(a,c){a?(x._trackError(a,c),0<x.waterfallAds.length?(0<x._adChainFork.length?(x._adChainFork[0].forkLength&&(x._adChainFork[0].forkLength--,0>=x._adChainFork[0].forkLength&&x._adChainFork.shift()),c=[].concat(x._adChainFork[0]||[])):c=[],x._getAd(x.waterfallAds.shift(),c,w)):m(a,c)):m(null,c)}var y=e&&c.isArray(e.ads)?e.ads:null;e=e&&c.isArray(e.adBreaks)?e.adBreaks:null;if(a)return x._trackError(a,y),m(a,y);y&&0<y.length?(y=x.waterfallAds=
x.waterfallAds.concat(y),x._getAd(y.shift(),[],w)):e&&0<e.length?r(e,m):m(new v("on AdsLoader._getVASTAd.validateVASTTree, no Ads in VAST response",303))})},validateVASTTree:function(a){var c=e.attr(a,"version");e.attr(a,"xmlns:vmap");return a.ad||a.adBreaks?c&&3!=c&&2!=c&&a.adBreaks&&1!=c?new v('on AdsLoader._getVASTAd.validateVASTTree, not supported VAST version "'+c+'"',102):c&&a.adBreaks&&1!=c?new v('on AdsLoader._getVASTAd.validateVASTTree, not supported VMAP version "'+c+'"',1001):null:new v("on AdsLoader._getVASTAd.validateVASTTree, no Ads in VAST response",
303)},_getAd:function(a,m,M){function r(a,c){w._requestVASTXml(a,function(a,m){if(a)return c(a);try{var r=e.toJXONTree(m);c(w.validateVASTTree(r),r.ad)}catch(za){c(new v("on AdsLoader._getVASTAd.requestVASTAd, error parsing xml",100))}})}var w=this;this._adChain=m||[];if(m.length>=w.config.WRAPPER_LIMIT)return M(new v("on AdsLoader._getVASTAd._getAd, players wrapper limit reached (the limit is "+w.config.WRAPPER_LIMIT+")",302),m);I.waterfall([function(c){"string"===typeof a?r(a,c):c(null,a)},function(a,
m){c.isArray(a)?m(null,a):w._buildAd(a,m)}],function(a,e){if(c.isArray(e)&&(w.waterfallAds=e.concat(w.waterfallAds),0<w.waterfallAds.length))return a=[].concat(m),a.forkLength=e.length,w._adChainFork.unshift(a),w._getAd(w.waterfallAds.shift(),m,M);e&&m.push(e);return a?M(a,m):e.wrapper?(e="undefined"!==typeof $BridIq&&$BridIq.isAdBlockEnabled()?"http://lkdasjdsaa98d7sadaslkjds.xyz/?"+btoa(e.wrapper.VASTAdTagURI):e.wrapper.VASTAdTagURI,w._getAd(e,m,M)):M(null,m)})},_buildAd:function(a,c){function m(a){var c=
a.wrapper;if((a=a.inLine)&&c)return new v("on AdsLoader._getVASTAd.validateAd, InLine and Wrapper both found on the same Ad",101);if(!a&&!c)return new v("on AdsLoader._getVASTAd.validateAd, nor wrapper nor inline elements found on the Ad",101);if(a&&0===a.creatives.length)return new v("on AdsLoader._getVASTAd.validateAd, missing creative in InLine element",101);if(c&&!c.VASTAdTagURI)return new v("on AdsLoader._getVASTAd.validateAd, missing 'VASTAdTagURI' in wrapper",101)}try{var e=new Y(a);c(m(e),
e)}catch(w){c(new v("on AdsLoader._getVASTAd._buildAd, error parsing xml",100),null)}},_requestVASTXml:function(e,m){function r(a){Brid.log("FIRE XML TAG LOADED",(new Date).getTime());m(null,a)}function x(a){if(0===parseInt(a)&&y)y=!1,Brid.Loader.loadText(c.urlParts(e).href,r,x,null,y);else return m(new v("undefined"!==typeof a?"on AdsLoader.requestVastXML, HTTP request error with status '"+a+"'":"on AdsLoader.requestVastXML, Error getting the the VAST XML with he passed adTagXML fn",301),null)}function w(a,
c,e){return a.split(c).join(e).split(c.toUpperCase()).join(e)}var y=!0,B=this.player;try{if(c.isFunction(e))e(requestHandler);else if(a.validateURL(e)){0<e.indexOf("//googleads")&&10>e.indexOf("//googleads")&&(e="https://ima3vpaid.appspot.com/?adTagUrl="+e+"&type=js");if(-1!==e.toLowerCase().indexOf("[timestamp]")){var u=(new Date).getTime();e=w(e,"[timestamp]",u)}-1!==e.toLowerCase().indexOf("[referrer_url]")&&(e=w(e,"[referrer_url]",encodeURIComponent(-1!==e.indexOf("doubleclick")?a.getEmbededUrl():
E.referrer||a.getEmbededUrl())));-1!==e.toLowerCase().indexOf("[description_url]")&&(e=w(e,"[description_url]",encodeURIComponent(a.getEmbededUrl())));-1!==e.toLowerCase().indexOf("[page_url]")&&(e=w(e,"[page_url]",encodeURIComponent(a.getEmbededUrl())));-1!==e.toLowerCase().indexOf("[video_title]")&&(e=w(e,"[video_title]",encodeURIComponent(B.currentSource.title)));-1!==e.toLowerCase().indexOf("[video_duration]")&&(e=w(e,"[video_duration]",B.duration()||B.currentSource.duration));-1!==e.toLowerCase().indexOf("[video_id]")&&
(e=w(e,"[video_id]",B.currentSource.id));-1!==e.toLowerCase().indexOf("[player_width]")&&B.el&&B.el.clientWidth&&(e=w(e,"[player_width]",B.el.clientWidth));-1!==e.toLowerCase().indexOf("[player_height]")&&B.el&&B.el.clientHeight&&(e=w(e,"[player_height]",B.el.clientHeight));-1!==e.toLowerCase().indexOf("[autoplay]")&&(e=w(e,"[autoplay]",B.config.autoplay?"1":"0"));-1!==e.toLowerCase().indexOf("[description]")&&(e=w(e,"[description]",encodeURIComponent(B.currentSource.description)));-1!==e.toLowerCase().indexOf("[mediafile_url]")&&
(e=w(e,"[mediafile_url]",encodeURIComponent(B.currentSource.src)));-1!==e.toLowerCase().indexOf("[dnt]")&&(e=w(e,"[dnt]",navigator.doNotTrack&&"1"===navigator.doNotTrack?"1":"0"));if(-1!==e.toLowerCase().indexOf("[user_agent]")){var A=encodeURIComponent(a.ua);e=w(e,"[user_agent]",A)}y=!0;Brid.log("FIRE TAG",e,(new Date).getTime());Brid.Loader.loadText(c.urlParts(e).href,r,x,null,y)}else m(null,e)}catch(xa){m(xa)}},_buildVASTResponse:function(a){a=a.length?a:[a];if("undefined"!==typeof a[0].breakId){var c=
new ta;a.forEach(function(a){c.addAdBreak(a)})}else{c=new sa;a.forEach(function(a){c.addAd(a)});if(c.hasLinear()&&"undefined"===typeof c.duration)throw new v("on AdsLoader._buildVASTResponse, Missing duration field in VAST response",101);(a=c.trackingEvents.progress)&&a.forEach(function(a){if(isNaN(a.offset))throw new v("on AdsLoader._buildVASTResponse, missing or wrong offset attribute on progress tracking event",101);})}return c},_trackError:function(a,e){if(c.isArray(e)&&0!==e.length){var m=[];
e.forEach(function(a){a.wrapper&&a.wrapper.error&&m.push(a.wrapper.error);a.inLine&&a.inLine.error&&m.push(a.inLine.error)});u.track(m,{ERRORCODE:a.code||900})}}});Brid.AdSDK.AdsManager=Brid.Sprite.extend({default:{adCancelTimeout:15E3,adsEnabled:!0},adManager:null,defaultCss:".brid-iab-blocker,.brid-static-container{position:absolute}.brid-iab-skip-button{position:absolute;bottom:3em;right:1em;color:#fff;font-size:14px!important;text-align:center;width:8em;height:3em;line-height:3em!important;background:#000;background:rgba(0,0,0,.8)}.brid-iab-blocker{top:0;left:0;width:100%;height:100%}.brid-static-container img{display:block;width:100%!important;height:auto!important}",
init:function m(c,e,w){m.base.call(this,c,e);a.createCSS(this.defaultCss,"bridVAST");c.add("error",this.$f(function(){this.adsCanceled=!0}));this.videoSlot=new J({id:c.id+"_video_slot",autoplay:c.config.autoplay,play_in_page:c.config.play_in_page,inpage_mobile:c.config.inpage_mobile});w.appendChild(this.videoSlot.el);this.container=w;this.player.add("newContent",this.$f(this.onNewContent));this.onNewContent();this.adsLoader=new ya({},c)},onNewContent:function(){this.playbackTech=E.fullscreenEnabled&&
"ogv"!==this.player.techName?this.videoSlot:this.player.tech},requestAd:function(e,u){this.isSpringServe=this.waitForPlaylistEnd=this.hasAdBreaks=this.adsCanceled=!1;var m=a.createElement("iframe",{className:"brid-tech brid-tech-iframe",src:"javascript:false",allow:"autoplay",marginWidth:"0",marginHeight:"0",frameBorder:"0",width:"100%",height:"100%"});Brid.log("FIRE ADD ourVpaidIframe IFRAME");this.container.appendChild(m);this.ourVpaidIframe=m;-1!=e.indexOf("correlator=")&&(c.queryStringToObj(e).correlator||
(e=e.replace(/correlator=/g,"correlator="+(new Date).getTime())));-1!=e.indexOf("springserve.com")&&(this.isSpringServe=!0);this.adCancelTimeoutId=setTimeout(this.$f(function(){this.adError(new v("timeout while waiting for the ad to start playing",402))}),this.config.adCancelTimeout);this.adsLoader.getVASTResponse(e,this.$f(function(a,c){this.adsCanceled||(this._clearAdCancelTimeout(),a?this.adError(a,c):(this._response=c,void 0!==c.adBreaks&&(this.hasAdBreaks=!0,this._playlistResponse=c),u()))}))},
_clearAdCancelTimeout:function(){this.adCancelTimeoutId&&(clearTimeout(this.adCancelTimeoutId),this.adCancelTimeoutId=null)},initializePlaybackTech:function(){this.onNewContent();(this.playbackTech!==this.player.tech||this.player.showOnAd())&&this.playbackTech.load()},playAd:function(){var a=this._response||this._playlistResponse;this.adsCanceled||(a||this.adError(new v("On AdsManager, missing required VASTResponse")),this.hasAdBreaks?this._scheduleAdBreaks():this._doPlayAd(a))},_scheduleAdBreaks:function(){function a(c){(e=
this._playlistResponse.prerollAdBreaks())&&0<e.length?this._requestAdBreak(e.shift()):(this.waitForPlaylistEnd=!1,this.remove(["vast.adEnd","vast.adError"],this.$f(a)),this.trigger("vast.contentResumeRequested"))}function c(){(w=this._playlistResponse.postrollAdBreaks())&&0<w.length?this._requestAdBreak(w.shift()):(this.waitForPlaylistEnd=!1,this.remove(["vast.adEnd","vast.adError"],this.$f(c)),this.trigger("vast.contentResumeRequested"))}var e=[],w=[],v=[],u=this.player;(e=this._playlistResponse.prerollAdBreaks())?
e.map(this.$f(function(c,e){0==e&&(!u.waitingForAd||u.isPlaying||u.ended()?u.addOnce("beforeStart",this.$f(function(){this.waitForPlaylistEnd=!0;this.add(["vast.adEnd","vast.adError"],this.$f(a));this._requestAdBreak(c)})):(this.waitForPlaylistEnd=!0,this.add(["vast.adEnd","vast.adError"],this.$f(a)),this._requestAdBreak(c)))})):this.trigger("vast.contentResumeRequested");(w=this._playlistResponse.postrollAdBreaks())&&w.map(this.$f(function(a,e){if(0==e)if(this.player.hasPostroll=!0,u.waitingForAd&&
u.ended())this.waitForPlaylistEnd=!0,this.add(["vast.adEnd","vast.adError"],this.$f(c)),this._requestAdBreak(a);else{var m=this.$f(function(){u.getAdInProgress()||(u.remove("ended",m),this.waitForPlaylistEnd=!0,this.add(["vast.adEnd","vast.adError"],this.$f(c)),this._requestAdBreak(a))});u.add("ended",m)}}));if(v=this._playlistResponse.midrollAdBreaks())this._midrollsCheck=this.$f(function(){this.midrollPlaying||u.getAdInProgress()||this._checkForMidrolls(v)}),u.add("timeupdate",this._midrollsCheck)},
_checkForMidrolls:function(a){function c(a,c){return("string"===typeof a.timeOffset?-1==a.timeOffset.indexOf("%")?a.timeOffset:a.timeOffset*e.duration()/100:a.timeOffset)<=c}for(var e=this.player,m=0;m<a.length;){if(c(a[m],e.currentTime())){this.midrollPlaying=!0;this.addOnce(["vast.adEnd","vast.adError"],this.$f(function(){this.midrollPlaying=!1}));this._requestAdBreak(a.shift());break}m++}0==a.length&&e.remove("timeupdate",this._midrollsCheck)},_requestAdBreak:function(a){function c(a){0<this.adsLoader.vastTree.ads.length?
this.adsLoader.getVASTResponse(this.adsLoader.vastTree.ads.shift(),this.$f(e)):this.remove(["vast.adError","vast.adEnd"],this.$f(c))}function e(c,e){if(!this.adsCanceled)if(c)this.currentAdBreak=null,this.adError(c,e);else{this._response=e;this._doPlayAd(e);if(c=a.trackingEvents)c.breakStart&&this.adManager.addOnce("vast.adStart",this.$f(m)),c.breakEnd&&this.adManager.addOnce("vast.adEnd",this.$f(v)),c.error&&this.adManager.addOnce("vast.adError",this.$f(u));this._clearAdCancelTimeout()}}function m(){this.adManager.tracker.trackEvent("breakStart",
!0,a)}function v(){this.adManager.tracker.trackEvent("breakEnd",!0,a)}function u(){this.adManager.tracker.trackEvent("error",!0,a)}a.played||(a.played=!0,this.currentAdBreak=a,this.adsCanceled=!1,a.adSource.allowMultipleAds&&this.add(["vast.adError","vast.adEnd"],this.$f(c)),this.adsLoader.getVASTResponse(a.adSource.adTagURI,this.$f(e)))},_doPlayAd:function(a){if(this.adManager)try{this.adManager.destroy(),this.adManager=null}catch(x){Brid.error("Brid AdSDK error removing VPAID",x)}this.addOnce("vast.adImpression",
this.$f(this._onAdImpressionCheckViewability));var c=a.mediaFiles;c.filter(u.isVPAID).length>=c.length?(this.isVPAID=!0,c=new U(this.player,this,this.playbackTech,{responseTimeout:this.config.adCancelTimeout},this.container)):(this.isVPAID=!1,this.ourVpaidIframe&&(Brid.log("REMOVE OUR VPAID IFRAME"),this.container.removeChild(this.ourVpaidIframe),delete this.ourVpaidIframe),c=new ua(this.player,this,this.playbackTech,{responseTimeout:this.config.adCancelTimeout},this.container));this.adManager=c;
this.adUnit=this.adManager.playAd(a)},_onAdImpressionCheckViewability:function(){function a(){w.player.isPlayerInView()&&!u&&(v=(new Date).getMilliseconds(),u=setInterval(c,50))}function c(){if(w.adManager&&w.adManager.tracker){var a=(new Date).getTime(),c=w.isLinear()?2E3:1E3;w.player.isPlayerInView()&&v+c<a?(e(),w.adManager.tracker.trackEvent("viewable_impression",!0),w.adManager.tracker.trackEvent("measurable_impression",!0)):!w.player.isPlayerInView()&&u&&(clearInterval(u),u=null)}}function e(){F.remove(C,
"scroll",a);u&&(clearInterval(u),u=null)}var w=this;if(w.player.isPlayerInView()){var v=(new Date).getTime();var u=setInterval(c,50)}else w.addOnce(["vast.adEnd","vast.adError"],e);F.add(C,"scroll",a)},stopAd:function(){this.adManager&&this.adManager.stop()},reset:function(){this.isVPAID=!1;this.adsCanceled=!0;this.currentAdBreak=null;if(this.adManager)try{this.adUnit=null,this.adManager.destroy(),this.adManager=null}catch(m){Brid.error("Brid AdSDK error removing VPAID",m)}},destroyAdsLoader:function(){this.adsLoader=
null},getAdDuration:function(){return this.isLinear()&&!isNaN(this.adManager.getAdDuration())&&isFinite(this.adManager.getAdDuration())?this.adManager.getAdDuration():"undefined"!=typeof this._response.duration?this._response.duration:0},getAdCurrentTime:function(){return this.isLinear()?this.adManager.getAdCurrentTime():0},setAdVolume:function(a){0==this.getAdVolume()&&0!=a?this.tracker&&this.tracker.trackUnmute():0!=this.getAdVolume()&&0==a&&this.tracker&&this.tracker.trackMute();this.adManager&&
this.adManager.setAdVolume(a)},getAdVolume:function(){return this.adManager?this.adManager.getAdVolume():0},isLinear:function(){return this._response?this.currentAdBreak&&"linear"==this.currentAdBreak.breakType||this._response.hasLinear():!1},resize:function(c,e,u,w,v){this.playbackTech&&this.isLinear()&&a.css(this.playbackTech,{height:w+"px"},!1,"important");this.adManager&&this.adManager.resize(c,e,u,w,v)},adError:function(a,c){Brid.error(a.message,a,c);this.ourVpaidIframe&&(this.container.removeChild(this.ourVpaidIframe),
delete this.ourVpaidIframe);this._clearAdCancelTimeout();0<this.adsLoader.waterfallAds.length?(this.adCancelTimeoutId=setTimeout(this.$f(function(){this.adError(new v("timeout while waiting for the ad to start playing",402))}),this.config.adCancelTimeout),this.adsLoader.getVASTResponse(this.adsLoader.waterfallAds.shift(),this.$f(function(a,c){this.adsCanceled||(a?this.adError(a,c):(this._clearAdCancelTimeout(),this._response=c,void 0!==c.adBreaks&&(this.hasAdBreaks=!0,this._playlistResponse=c),this.playAd()))}))):
(this.isVPAID=!1,this.adsCanceled=!0,this.trigger("vast.adError",{error:a}))}})})(window,document);
